LAMMPS (19 Nov 2024)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:99)
  using 1 OpenMP thread(s) per MPI task
<<<<<<< HEAD
Open of file C:\Users\PanGroupWorkstation\Desktop\LAMMPS USER-REBOMOS Plugin 15Jun2023-MSMPI\rebomosplugin.so failed: 
Loaded 0 plugins from C:\Users\PanGroupWorkstation\Desktop\LAMMPS USER-REBOMOS Plugin 15Jun2023-MSMPI
Loaded 1 plugins from C:\Users\PanGroupWorkstation\AppData\Local\LAMMPS 64-bit 17Apr2024\plugins
# input file for producing initial structure
=======
Loaded 1 plugins from C:\Users\raven\AppData\Local\LAMMPS 64-bit 19Nov2024\plugins
# input file for producing initial structure without relaxation
>>>>>>> bd84377168056d2a54aaed404a6b8127acba4d5b

# initial settings
units metal
dimension 3
boundary p p p
atom_style charge
# atom_modify map array

# variable size equal 20         # model size
# variable latparam equal 3.50   # initial lattice parameter

<<<<<<< HEAD
# lattice         fcc ${latparam}
# region          box block 0 ${size} 0 ${size} 0 ${size}
# create_box      3 box
# create_atoms    1 box
# substitute one type of atom with another type of atom, can be used to create multi-components system

# variables
variable cutoff equal 1.25
variable angle equal 0.34

# read data
read_data  SrTiO3_0.5_0.txt #../../../initial_structure/additional_data/SrTiO3_2_0.34.data
Reading data file ...
  orthogonal box = (0 -47.504091 0) to (237.52045 47.504091 7.89)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  13872 atoms
  read_data CPU = 0.132 seconds
=======
# variables
variable latparam equal 3.945
variable degree equal 10
variable scale equal sqrt(145)
variable nx equal 2
variable ny equal 3
variable nz equal 6
variable pi equal 3.14159265
variable x_scale equal v_latparam/tan(v_degree/2*v_pi/180)

variable xmin equal 0
variable xmax equal "v_x_scale*v_nx + 2*v_latparam"
variable ymin equal "-1*v_ny*v_scale*v_latparam"
variable ymax equal "v_ny*v_scale*v_latparam"
variable zmin equal 0
variable zmax equal "v_nz*v_latparam"

variable xcenter equal "(v_xmin+v_xmax)/2"
variable ycenter equal 0
variable zcenter equal "(v_zmin+v_zmax)/2"

variable disp_x equal "v_latparam*v_scale*0.0"
variable disp_z equal "v_latparam*0.0"
# print "${disp}"

region whole block ${xmin} ${xmax} ${ymin} ${ymax} ${zmin} ${zmax} units box
region whole block 0 ${xmax} ${ymin} ${ymax} ${zmin} ${zmax} units box
region whole block 0 98.0731127723612 ${ymin} ${ymax} ${zmin} ${zmax} units box
region whole block 0 98.0731127723612 -142.512271840007 ${ymax} ${zmin} ${zmax} units box
region whole block 0 98.0731127723612 -142.512271840007 142.512271840007 ${zmin} ${zmax} units box
region whole block 0 98.0731127723612 -142.512271840007 142.512271840007 0 ${zmax} units box
region whole block 0 98.0731127723612 -142.512271840007 142.512271840007 0 23.67 units box
create_box 3 whole
Created orthogonal box = (0 -142.51227 0) to (98.073113 142.51227 23.67)
  1 by 1 by 1 MPI processor grid

region lower block INF INF ${ymin} ${ycenter} INF INF units box
region lower block INF INF -142.512271840007 ${ycenter} INF INF units box
region lower block INF INF -142.512271840007 0 INF INF units box

lattice custom 1         orient x 102 -9 0 orient y 9 102 0 orient z 0 0 1         a1 ${latparam} 0 0 a2 0 ${latparam} 0 a3 0 0 ${latparam}         basis 0 0 0         basis 0.5 0.5 0.5         basis 0.0 0.5 0.5         basis 0.5 0.0 0.5         basis 0.5 0.5 0.0
lattice custom 1         orient x 102 -9 0 orient y 9 102 0 orient z 0 0 1         a1 3.945 0 0 a2 0 ${latparam} 0 a3 0 0 ${latparam}         basis 0 0 0         basis 0.5 0.5 0.5         basis 0.0 0.5 0.5         basis 0.5 0.0 0.5         basis 0.5 0.5 0.0
lattice custom 1         orient x 102 -9 0 orient y 9 102 0 orient z 0 0 1         a1 3.945 0 0 a2 0 3.945 0 a3 0 0 ${latparam}         basis 0 0 0         basis 0.5 0.5 0.5         basis 0.0 0.5 0.5         basis 0.5 0.0 0.5         basis 0.5 0.5 0.0
lattice custom 1         orient x 102 -9 0 orient y 9 102 0 orient z 0 0 1         a1 3.945 0 0 a2 0 3.945 0 a3 0 0 3.945         basis 0 0 0         basis 0.5 0.5 0.5         basis 0.0 0.5 0.5         basis 0.5 0.0 0.5         basis 0.5 0.5 0.0
Lattice spacing in x,y,z = 4.2764733 4.2764733 3.945

create_atoms 1 region lower                basis 1 1                basis 2 2                basis 3 3                basis 4 3                basis 5 3
Created 26982 atoms
  using lattice units in orthogonal box = (0 -142.51227 0) to (98.073113 142.51227 23.67)
  create_atoms CPU = 0.002 seconds

region upper block INF INF ${ycenter} ${ymax} INF INF units box
region upper block INF INF 0 ${ymax} INF INF units box
region upper block INF INF 0 142.512271840007 INF INF units box

lattice custom 1         orient x 102 9 0 orient y -9 102 0 orient z 0 0 1         a1 ${latparam} 0 0 a2 0 ${latparam} 0 a3 0 0 ${latparam}         basis 0 0 0         basis 0.5 0.5 0.5         basis 0.0 0.5 0.5         basis 0.5 0.0 0.5         basis 0.5 0.5 0.0
lattice custom 1         orient x 102 9 0 orient y -9 102 0 orient z 0 0 1         a1 3.945 0 0 a2 0 ${latparam} 0 a3 0 0 ${latparam}         basis 0 0 0         basis 0.5 0.5 0.5         basis 0.0 0.5 0.5         basis 0.5 0.0 0.5         basis 0.5 0.5 0.0
lattice custom 1         orient x 102 9 0 orient y -9 102 0 orient z 0 0 1         a1 3.945 0 0 a2 0 3.945 0 a3 0 0 ${latparam}         basis 0 0 0         basis 0.5 0.5 0.5         basis 0.0 0.5 0.5         basis 0.5 0.0 0.5         basis 0.5 0.5 0.0
lattice custom 1         orient x 102 9 0 orient y -9 102 0 orient z 0 0 1         a1 3.945 0 0 a2 0 3.945 0 a3 0 0 3.945         basis 0 0 0         basis 0.5 0.5 0.5         basis 0.0 0.5 0.5         basis 0.5 0.0 0.5         basis 0.5 0.5 0.0
Lattice spacing in x,y,z = 4.2764733 4.2764733 3.945

create_atoms 1 region upper                basis 1 1                basis 2 2                basis 3 3                basis 4 3                basis 5 3
Created 26982 atoms
  using lattice units in orthogonal box = (0 -142.51227 0) to (98.073113 142.51227 23.67)
  create_atoms CPU = 0.003 seconds

# substitute one type of atom with another type of atom, can be used to create multi-components system

group lower region lower
26994 atoms in group lower
group upper region upper
26994 atoms in group upper

displace_atoms lower move ${disp_x} 0 0 units box
displace_atoms lower move 0 0 0 units box
Displacing atoms ...
displace_atoms lower move 0 0 ${disp_z} units box
displace_atoms lower move 0 0 0 units box
Displacing atoms ...

# rotate around y axis
variable angle equal 0 # <angle>
displace_atoms lower rotate ${xcenter} ${ycenter} ${zcenter} 0 1 0 ${angle} # 0.34
displace_atoms lower rotate 49.0365563861806 ${ycenter} ${zcenter} 0 1 0 ${angle} 
displace_atoms lower rotate 49.0365563861806 0 ${zcenter} 0 1 0 ${angle} 
displace_atoms lower rotate 49.0365563861806 0 11.835 0 1 0 ${angle} 
displace_atoms lower rotate 49.0365563861806 0 11.835 0 1 0 0 
Displacing atoms ...
displace_atoms upper rotate ${xcenter} ${ycenter} ${zcenter} 0 1 0 -${angle}
displace_atoms upper rotate 49.0365563861806 ${ycenter} ${zcenter} 0 1 0 -${angle}
displace_atoms upper rotate 49.0365563861806 0 ${zcenter} 0 1 0 -${angle}
displace_atoms upper rotate 49.0365563861806 0 11.835 0 1 0 -${angle}
displace_atoms upper rotate 49.0365563861806 0 11.835 0 1 0 -0
Displacing atoms ...

# read data
# read_data ../../model/bicrystal.lmp
# read_data SrTiO3_npt.data
>>>>>>> bd84377168056d2a54aaed404a6b8127acba4d5b

mass 1 87.62000000    # Sr
mass 2 47.86700000    # Ti
mass 3 15.99900000    # O

<<<<<<< HEAD
# set type 1 charge <Sr_charge>
# set type 2 charge <Ti_charge>
# set type 3 charge <O_charge>
=======
set type 1 charge 1.2
Setting atom values ...
  10800 settings made for charge
set type 2 charge 2.4
Setting atom values ...
  10788 settings made for charge
set type 3 charge -1.2
Setting atom values ...
  32376 settings made for charge
>>>>>>> bd84377168056d2a54aaed404a6b8127acba4d5b

# potential settings (required but not important)

pair_style lj/cut 2.5
pair_coeff * * 1 1

# delete overlap atoms
<<<<<<< HEAD
#variable cutoff equal 1.8
#delete_atoms overlap ${cutoff} all all

compute peratom all pe/atom

variable tcharge equal charge(all)
print "total charge is now ${tcharge}"
total charge is now 4.05887188877168
=======
variable cutoff equal 0.5 # <cutoff>
delete_atoms overlap ${cutoff} lower upper
delete_atoms overlap 0.5 lower upper
System init for delete_atoms ...
Generated 0 of 3 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.5
  ghost atom cutoff = 4.5
  binsize = 2.25, bins = 44 127 11
  2 neighbor lists, perpetual/occasional/extra = 1 1 0
  (1) command delete_atoms, occasional
      attributes: full, newton on
      pair build: full/bin/atomonly
      stencil: full/bin/3d
      bin: standard
  (2) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/3d
      bin: standard
Deleted 114 atoms, new total = 53850

# reset ion charges
group negative type 3
32316 atoms in group negative
group positive subtract all negative
21534 atoms in group positive
variable totalCharge equal charge(all)
variable numofpositive equal count(positive)
variable numofnegative equal count(negative)
variable positiveCharge equal "0.5*v_totalCharge/v_numofpositive"
variable negativeCharge equal "0.5*v_totalCharge/v_numofnegative"
variable charge1 equal "1.2-v_positiveCharge"
variable charge2 equal "2.4-v_positiveCharge"
variable charge3 equal "-1.2-v_negativeCharge"

print "----------charge information------------"
----------charge information------------
print "total charge is now ${totalCharge}"
total charge is now -14.3999999999931
print "positive charge is now ${positiveCharge}"
positive charge is now -0.000334354973530071
print "negative charge is now ${negativeCharge}"
negative charge is now -0.000222799851466659
print "charge1 is now ${charge1}"
charge1 is now 1.20033435497353
print "charge2 is now ${charge2}"
charge2 is now 2.40033435497353
print "charge3 is now ${charge3}"
charge3 is now -1.19977720014853
>>>>>>> bd84377168056d2a54aaed404a6b8127acba4d5b

variable num_of_atoms equal count(all)

<<<<<<< HEAD
minimize 1e-25 1e-25 20000 20000
PPPMDisp initialization ...
WARNING: System is not charge neutral, net charge = 4.0588719 (src/kspace.cpp:327)
Generated 0 of 3 mixed pair_coeff terms from geometric mixing rule
  Coulomb G vector (1/distance)= 0.7459775020649633
  Coulomb grid = 720 288 24
  Coulomb stencil order = 5
  Coulomb estimated absolute RMS force accuracy = 0.00015318087
  Coulomb estimated relative force accuracy = 1.0637823e-05
  using double precision FFTW3
  3d grid and FFT values/proc = 7649915 4976640
=======
print "${cutoff} ${charge1} ${charge2} ${charge3} ${num_of_atoms}" append charge.txt
0.5 1.20033435497353 2.40033435497353 -1.19977720014853 53850

set type 1 charge ${charge1}
set type 1 charge 1.20033435497353
Setting atom values ...
  10764 settings made for charge
set type 2 charge ${charge2}
set type 2 charge 2.40025078952041
Setting atom values ...
  10770 settings made for charge
set type 3 charge ${charge3}
set type 3 charge -1.19987467508463
Setting atom values ...
  32316 settings made for charge

write_data SrTiO3_${cutoff}_${angle}.data nocoeff
write_data SrTiO3_0.5_${angle}.data nocoeff
write_data SrTiO3_0.5_0.data nocoeff
System init for write_data ...
>>>>>>> bd84377168056d2a54aaed404a6b8127acba4d5b
Generated 0 of 3 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
<<<<<<< HEAD
  master list distance cutoff = 6.5
  ghost atom cutoff = 6.5
  binsize = 3.25, bins = 74 30 3
  3 neighbor lists, perpetual/occasional/extra = 3 0 0
  (1) pair morse, perpetual
=======
  master list distance cutoff = 4.5
  ghost atom cutoff = 4.5
  binsize = 2.25, bins = 44 127 11
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
>>>>>>> bd84377168056d2a54aaed404a6b8127acba4d5b
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/3d
      bin: standard
<<<<<<< HEAD
  (2) pair lj/long/coul/long, perpetual, skip from (1)
      attributes: half, newton on
      pair build: skip
      stencil: none
      bin: none
  (3) pair morse, perpetual, copy from (1)
      attributes: half, newton on
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 1186 | 1186 | 1186 Mbytes
   Step          Temp            Lx             Ly             Lz           PotEng          Pxx            Pyy            Pzz           Press          Volume    
         0   0              237.52045      95.008181      7.89          -167504.94     -5051.6693     -6020.6894     -10656.459     -7242.9392      178048.79    
        80   0              237.52045      95.008181      7.89          -168102.8      -20607.329     -32788.984     -25123.936     -26173.416      178048.79    
Loop time of 264.755 on 1 procs for 80 steps with 13872 atoms

99.7% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = linesearch alpha is zero
  Energy initial, next-to-last, final = 
     -167504.944101668  -168102.798196881  -168102.798196881
  Force two-norm initial, final = 169.97579 1.1469802
  Force max component initial, final = 11.346111 0.17486286
  Final line search alpha, max atom move = 8.3823472e-09 1.4657612e-09
  Iterations, force evaluations = 80 187

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 4.3134     | 4.3134     | 4.3134     |   0.0 |  1.63
Kspace  | 260.25     | 260.25     | 260.25     |   0.0 | 98.30
Neigh   | 0.059835   | 0.059835   | 0.059835   |   0.0 |  0.02
Comm    | 0.05389    | 0.05389    | 0.05389    |   0.0 |  0.02
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.08191    |            |       |  0.03

Nlocal:          13872 ave       13872 max       13872 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:          32913 ave       32913 max       32913 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:         631724 ave      631724 max      631724 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 631724
Ave neighs/atom = 45.539504
Neighbor list builds = 2
Dangerous builds = 0

# relax box
reset_timestep 0
fix 1 all box/relax aniso 0.0 vmax 0.001
# fix 1 all box/relax aniso 0.0 vmax 0.001 fixedpoint 0 0 0
# fix 1 all box/relax y 0.0 vmax 0.001
#dump 1 all custom 20000 SrTiO3_min.dump.* id type q x y z c_peratom
#dump_modify 1 sort id
min_style cg
minimize  1e-25 1e-25 20000 20000
PPPMDisp initialization ...
Generated 0 of 3 mixed pair_coeff terms from geometric mixing rule
  Coulomb G vector (1/distance)= 0.7459775020649418
  Coulomb grid = 720 288 24
  Coulomb stencil order = 5
  Coulomb estimated absolute RMS force accuracy = 0.00015318083
  Coulomb estimated relative force accuracy = 1.063782e-05
  using double precision FFTW3
  3d grid and FFT values/proc = 7649915 4976640
Generated 0 of 3 mixed pair_coeff terms from geometric mixing rule
WARNING: Energy due to 3 extra global DOFs will be included in minimizer energies
 (src/min.cpp:219)
Per MPI rank memory allocation (min/avg/max) = 1186 | 1186 | 1186 Mbytes
   Step          Temp            Lx             Ly             Lz           PotEng          Pxx            Pyy            Pzz           Press          Volume    
         0   0              237.52045      95.008181      7.89          -168102.8      -20607.329     -32788.984     -25123.936     -26173.416      178048.79    
        14   0              237.37266      93.803464      7.8556149     -168136.3       53.954889      55.946405      66.240202      58.713832      174916.09    
Loop time of 142.165 on 1 procs for 14 steps with 13872 atoms

99.8% CPU use with 1 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = linesearch alpha is zero
  Energy initial, next-to-last, final = 
      -168102.79819688  -168136.295067118  -168136.295067118
  Force two-norm initial, final = 5130.0258 13.443758
  Force max component initial, final = 3643.8176 7.263365
  Final line search alpha, max atom move = 6.306307e-11 4.5805009e-10
  Iterations, force evaluations = 14 57

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 1.3302     | 1.3302     | 1.3302     |   0.0 |  0.94
Kspace  | 63.932     | 63.932     | 63.932     |   0.0 | 44.97
Neigh   | 0.023103   | 0.023103   | 0.023103   |   0.0 |  0.02
Comm    | 0.015914   | 0.015914   | 0.015914   |   0.0 |  0.01
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 76.86      |            |       | 54.07

Nlocal:          13872 ave       13872 max       13872 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:          32892 ave       32892 max       32892 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:         638322 ave      638322 max      638322 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 638322
Ave neighs/atom = 46.015138
Neighbor list builds = 1
Dangerous builds = 0

write_data SrTiO3_relaxed_${cutoff}_${angle}.data nocoeff
write_data SrTiO3_relaxed_1.25_${angle}.data nocoeff
write_data SrTiO3_relaxed_1.25_0.34.data nocoeff
System init for write_data ...
PPPMDisp initialization ...
Generated 0 of 3 mixed pair_coeff terms from geometric mixing rule
  Coulomb G vector (1/distance)= 0.7472107282842126
  Coulomb grid = 720 288 24
  Coulomb stencil order = 5
  Coulomb estimated absolute RMS force accuracy = 0.00014994496
  Coulomb estimated relative force accuracy = 1.0413101e-05
  using double precision FFTW3
  3d grid and FFT values/proc = 7649915 4976640
Generated 0 of 3 mixed pair_coeff terms from geometric mixing rule
Total wall time: 0:58:20
=======

# dump 1 all custom 20000 SrTiO3_min_1.8.dump.* id type q x y z
# dump_modify 1 sort id
# min_style cg
# minimize  1e-25 1e-25 20000 20000
Total wall time: 0:00:00
>>>>>>> bd84377168056d2a54aaed404a6b8127acba4d5b
